slash_sir <- function(n, m){
x <- rnorm(n)
f <- sapply(x, function(y)
integrate(function(u) dnorm(u * y) * u, lower = 0, upper = 1)$value)
g <- dnorm(x)
w <- f / g
w_norm <- w / sum(w)
indice <- sample(seq_len(n), size = m, replace = TRUE, prob = w_norm)
x_sir <- x[indice]
return(x_sir)
}
install.packages("nortest")
install.packages("tseries")
chi_rejection <- function(n){
x <- numeric(n)
i <- 0
while(i < n){
y_candidato <- rexp(1, rate=1/4)
U <- runif(1, 0, 1)
if(U <= exp(-y_candidato/4)){
i <- i + 1
x[i] <- y_candidato
}
}
}
pareto_icdf <- function(n, a, b){
U <- runif(n, 0, 1)
x <- b * (U^(-1/a))
}
slash_sir <- function(n, m){
x <- rnorm(n)
f <- sapply(x, function(y)
integrate(function(u) dnorm(u * y) * u, lower = 0, upper = 1)$value)
g <- dnorm(x)
w <- f / g
w_norm <- w / sum(w)
indice <- sample(seq_len(n), size = m, replace = TRUE, prob = w_norm)
x_sir <- x[indice]
return(x_sir)
}
library(nortest)
library(tseries)
poder_mc <- function(geradora, n, m = 1000, alpha = 0.05) {
rejeita_sw <- rejeita_ad <- rejeita_jb <- numeric(m)
for (i in 1:m) {
x <- geradora(n)
p_sw <- shapiro.test(x)$p.value
p_ad <- ad.test(x)$p.value
p_jb <- jarque.bera.test(x)$p.value
rejeita_sw[i] <- (p_sw < alpha)
rejeita_ad[i] <- (p_ad < alpha)
rejeita_jb[i] <- (p_jb < alpha)
}
data.frame(
Tamanho = n,
`Réplicas` = m,
`Erro Tipo I` = alpha,
`Shapiro-Wilk` = mean(rejeita_sw),
`Anderson-Darling` = mean(rejeita_ad),
`Jarque-Bera` = mean(rejeita_jb)
)
}
poder_mc(function(n) chi_rejection(n), n = 50, m = 1000)
poder_mc(function(n) pareto_icdf(n, a = 2, b = 1), n = 50, m = 1000)
poder_mc(function(n) slash_sir(n, m), n = 50, m = 1000)
poder_mc(function(n) slash_sir(n, m = n), n = 50, m = 1000)
library(nortest)
library(tseries)
poder_mc <- function(geradora, n, m = 1000, alpha = 0.05) {
rejeita_sw <- rejeita_ad <- rejeita_jb <- numeric(m)
for (i in 1:m) {
x <- geradora(n)
p_sw <- shapiro.test(x)$p.value
p_ad <- ad.test(x)$p.value
p_jb <- jarque.bera.test(x)$p.value
rejeita_sw[i] <- (p_sw < alpha)
rejeita_ad[i] <- (p_ad < alpha)
rejeita_jb[i] <- (p_jb < alpha)
}
data.frame(
Tamanho = n,
`Réplicas` = m,
`Erro Tipo I` = alpha,
`Poder Shapiro-Wilk` = mean(rejeita_sw),
`Poder Anderson-Darling` = mean(rejeita_ad),
`Poder Jarque-Bera` = mean(rejeita_jb)
)
}
poder_mc(function(n) slash_sir(n, m = n), n = 50, m = 1000)
chi_rejection <- function(n){
x <- numeric(n)
i <- 0
while(i < n){
y_candidato <- rexp(1, rate=1/4)
U <- runif(1, 0, 1)
if(U <= exp(-y_candidato/4)){
i <- i + 1
x[i] <- y_candidato
}
}
return(x)
}
poder_mc(function(n) chi_rejection(n), n = 50, m = 1000)
chi_rejection <- function(n){
x <- numeric(n)
i <- 0
while(i < n){
y_candidato <- rexp(1, rate=1/4)
U <- runif(1, 0, 1)
if(U <= exp(-y_candidato/4)){
i <- i + 1
x[i] <- y_candidato
}
}
return(x) #tive que colocar porque is.numeric(x) = FALSE
}
pareto_icdf <- function(n, a, b){
U <- runif(n, 0, 1)
x <- b * (U^(-1/a))
}
slash_sir <- function(n, m){
x <- rnorm(n)
f <- sapply(x, function(y)
integrate(function(u) dnorm(u * y) * u, lower = 0, upper = 1)$value)
g <- dnorm(x)
w <- f / g
w_norm <- w / sum(w)
indice <- sample(seq_len(n), size = m, replace = TRUE, prob = w_norm)
x_sir <- x[indice]
return(x_sir)
}
library(nortest)
library(tseries)
poder_mc <- function(geradora, n, m = 1000, alpha = 0.05) {
rejeita_sw <- rejeita_ad <- rejeita_jb <- numeric(m)
for (i in 1:m) {
x <- geradora(n)
p_sw <- shapiro.test(x)$p.value
p_ad <- ad.test(x)$p.value
p_jb <- jarque.bera.test(x)$p.value
rejeita_sw[i] <- (p_sw < alpha)
rejeita_ad[i] <- (p_ad < alpha)
rejeita_jb[i] <- (p_jb < alpha)
}
data.frame(
Tamanho = n,
`Réplicas` = m,
`Poder Shapiro-Wilk` = mean(rejeita_sw),
`Poder Anderson-Darling` = mean(rejeita_ad),
`Poder Jarque-Bera` = mean(rejeita_jb)
)
}
poder_mc(function(n) chi_rejection(n), n = 50, m = 1000)
poder_mc(function(n) pareto_icdf(n, a = 2, b = 1), n = 50, m = 1000)
poder_mc(function(n) slash_sir(n, m = n), n = 50, m = 1000)
